承知いたしました。GitHub（Markdown管理）を採用し、さらに「6ヶ月経過した記事の自動削除ロジック」を組み込んだ、Antigravityにそのまま読み込ませるためのシステム仕様書を作成しました。

このテキストをコピーして、Antigravityのエージェントに「この仕様書に従ってプロジェクトを作成して」と指示してください。

---

# システム仕様書：日本株AI自動ブログシステム (Project: Antigravity-Stock-Blog)

## 1. 概要

本システムは、日本株の市況情報を自動収集し、Geminiを用いて生成したブログ記事をGitHub上にMarkdown形式で投稿する。また、運用コストとストレージを考慮し、投稿から6ヶ月が経過した記事を自動的に削除するメンテナンス機能を備える。
無料で作成するため、CMSなどは利用しない。

## 2. 技術スタック

* **フレームワーク:** Astro (静的サイト生成 / SSG)
* **ホスティング:** GitHub Pages (または Vercel / Cloudflare Pages)
* **言語:** TypeScript / Python (収集・加工用)
* **生成AI:** Gemini 3 API (Google AI Studio)
* **自動化:** GitHub Actions (定時実行)
* **管理手法:** GitHubリポジトリへのMarkdownコミットベース

## 3. 主要機能

### 3.1 データ収集・執筆フェーズ (Daily Task)

* **実行時間:** 市場閉場後（例：毎日 11:40 JST）
* **情報源:** みんかぶの株価下落ランキング（https://minkabu.jp/financial_item_ranking/fall?exchange=tokyo.prime&order=asc）、株探の人気ニュースにランクインしている数記事の詳細（https://kabutan.jp/info/accessranking/2_1）
* **動作:** 1. Browser Subagent（またはスクレイピング）により、日経平均終値、騰落、注目ニュースを取得。
2. Gemini APIに取得データを渡し、Markdown形式の記事本文を生成。
3. ファイル名を `src/content/blog/YYYY-MM-DD-stock-report.md` として保存。

### 3.2 自動デプロイフェーズ

* **動作:** 1. 生成されたファイルを GitHub に `git commit` & `push` する。
2. GitHub Actions がビルド（`npm run build`）を実行し、サイトを更新する。

### 3.3 自動メンテナンスフェーズ (Lifecycle Management)

* **動作:** 1. 毎日（または週1回）のビルドプロセス中に、`src/content/blog/` 内のファイルを走査。
2. ファイル名またはフロントマターの日付が **現在より180日（6ヶ月）以上前** の場合、そのファイルを自動削除（`rm`）する。
3. 削除後、最新の状態でリポジトリを更新する。

## 4. フォルダ構造案

```text
/
├── .github/workflows/   # 自動投稿・削除のAction定義
├── src/
│   ├── content/
│   │   └── blog/        # ここにMarkdown記事が蓄積・削除される
│   └── pages/           # Astroのページコンポーネント
├── scripts/
│   ├── collect_data.py  # データ収集・Gemini連携スクリプト
│   └── cleanup_posts.js # 6ヶ月経過記事の削除スクリプト
└── astro.config.mjs

```

## 5. Antigravityへの実装指示（プロンプト）

エージェントに対し、以下の手順での実行を指示してください。

1. **Step 1:** 「Astroのブログテンプレートを使用して、GitHub Pagesにデプロイ可能なベースコードを作成してください。」
2. **Step 2:** 「毎日11:40に実行されるGitHub Actionsを作成してください。内容は『Gemini APIを使って日本株の記事をMarkdownで生成し、リポジトリにコミットする』ものです。」
3. **Step 3:** 「`src/content/blog/` 内のファイルをチェックし、6ヶ月を過ぎた古い記事を自動削除するクリーンアップ・スクリプトを実装し、Actionsに組み込んでください。」

## 6. 注意事項

* **API制限:** Gemini APIの無料枠の範囲内で動作するよう、収集データ量とプロンプトサイズを調整する。
* **削除の例外:** 特定の重要な記事（例：固定記事や振り返り記事）を削除対象外にする場合は、Markdownのフロントマターに `keep: true` フラグを立てるロジックを検討する。

---

### Antigravityを動かす際のアドバイス

Antigravityにこの仕様書を渡した後、**「まずはGitHub Pagesで空のブログが公開されるところまでやって」**とスモールステップで指示すると、エラーが起きた際も原因が特定しやすくなります。

「6ヶ月での削除」については、**「ファイル名の日付から経過日数を計算するNode.jsスクリプトを作って」**と個別指示すると、より正確に実装してくれますよ！